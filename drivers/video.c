#include "../include/video.h"void init_graph(void){	/*???????????*/	xsize = 800;	ysize = 600;	bpp = 24;	vram_len = (((xsize * ysize) * (bpp / 8)) & 0xfffff000) + 0x1000;	vram = (char *) kmalloc(vram_len);	kmap(vram,0xe0000000,vram_len);}/*refresh all the video RAM function*/void refresh_scr(unsigned char *buffer){	unsigned int buf_point = 0, vram_point = 0;	while (vram_point < vram_len)	{		vram[vram_point] = (buffer[buf_point+3] * buffer[buf_point]) / 0xff;/*?????*/		vram[vram_point+1] = (buffer[buf_point+3] * buffer[buf_point+1]) / 0xff;/*?????*/		vram[vram_point+2] = (buffer[buf_point+3] * buffer[buf_point+2]) / 0xff;/*?????*/		buf_point += 4;/*???32Î»?????*/		vram_point += (bpp / 8);	}}void refresh_pix_32(unsigned long x, unsigned int long y, unsigned int color){	int long i;	unsigned char alpha;	if (x < xsize & y < ysize)	{		alpha = color >> 24;		i = ((y * xsize) + x)*3;		vram[i] = (alpha * color) / 0xff;		vram[i+1] = ((alpha * color) >> 8) / 0xff;		vram[i+2] = ((alpha * color) >> 16) / 0xff;	}}void put_pix_24(unsigned int x, unsigned int y, unsigned int color){	int i;	if (x < xsize & y < ysize)	{		i = ((y * xsize) + x)*3;		vram[i] = color;		vram[i+1] = color >> 8;		vram[i+2] = color >> 16;	}}unsigned int get_pix_24(unsigned int x, unsigned int y){	unsigned int i;	if (x < xsize & y < ysize)	{		i = ((y * xsize) + x)*3;		return (vram[i] + (vram[i+1] << 8) + (vram[i+2] << 16));	}}